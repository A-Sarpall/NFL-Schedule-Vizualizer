<!DOCTYPE html>
<html lang="en">
<head>
    <title>NFL Schedule Visualizer</title>
    <link rel="stylesheet" href="main.css">
    <script type="module" src="map.js" defer></script>
    <!-- Commented out the old script loading Google Maps -->
    <!-- <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDIGk3VO9K19xgxwV38DdP5AeJrAklNeBc&loading=async&callback=initMap" defer></script> -->
</head>
<body>
    <h3>NFL Schedule Visualizer</h3>
    <div>
        <label for="team-select">Choose a team:</label>
        <select id="team-select">
            <option value="none">Select a team</option>
            <option value="arizona">Arizona Cardinals</option>
            <option value="atlanta">Atlanta Falcons</option>
            <option value="baltimore">Baltimore Ravens</option>
            <option value="buffalo">Buffalo Bills</option>
            <option value="carolina">Carolina Panthers</option>
            <option value="chicago">Chicago Bears</option>
            <option value="cincinnati">Cincinnati Bengals</option>
            <option value="cleveland">Cleveland Browns</option>
            <option value="dallas">Dallas Cowboys</option>
            <option value="denver">Denver Broncos</option>
            <option value="detroit">Detroit Lions</option>
            <option value="green bay">Green Bay Packers</option>
            <option value="houston">Houston Texans</option>
            <option value="indianapolis">Indianapolis Colts</option>
            <option value="jacksonville">Jacksonville Jaguars</option>
            <option value="kansas city">Kansas City Chiefs</option>
            <option value="lac">Los Angeles Chargers</option>
            <option value="lar">Los Angeles Rams</option>
            <option value="las vegas">Las Vegas Raiders</option>
            <option value="miami">Miami Dolphins</option>
            <option value="minnesota">Minnesota Vikings</option>
            <option value="new england">New England Patriots</option>
            <option value="new orleans">New Orleans Saints</option>
            <option value="nyg">New York Giants</option>
            <option value="nyj">New York Jets</option>
            <option value="philadelphia">Philadelphia Eagles</option>
            <option value="pittsburgh">Pittsburgh Steelers</option>
            <option value="seattle">Seattle Seahawks</option>
            <option value="san francisco">San Francisco 49ers</option>
            <option value="tampa bay">Tampa Bay Buccaneers</option>
            <option value="tennessee">Tennessee Titans</option>
            <option value="washington">Washington Commanders</option>
        </select>
    </div>
    <div id="map"></div>

    <script>
        async function loadGoogleMaps() {
            try {
                const response = await fetch('/.netlify/functions/get-api-key');
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const data = await response.json();
                const script = document.createElement('script');
                script.src = `https://maps.googleapis.com/maps/api/js?key=${data.apiKey}&callback=initMap`;
                script.defer = true;
                document.head.appendChild(script);
            } catch (error) {
                console.error('There was a problem with the fetch operation:', error);
            }
        }
        
        loadGoogleMaps();
        
    </script>
    
</body>
</html>
